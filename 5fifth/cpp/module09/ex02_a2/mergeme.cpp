# include <algorithm>
# include <vector>
# include <math.h>
# include <iostream>

// determine which index to jam in next
int	jacobsthal_num_gen()
{
	static int jn;
	static int n;

	if (n == 0)
		jn = 0;
	else if (n == 1)
		jn = 1;
	else
		jn = pow(2, n) - jn;
	++n;
	return jn;
}

int	binary_search(	std::vector<int> &in, 
						size_t group_size, 
						size_t which, 
						int start, 
						int stop
)
{
	int							last_elem_loc = group_size - 1;
	int							midpoint = ((stop - start) / 2) + start;

	std::vector<int>::iterator	tomatch_start = in.begin() + (which * group_size);
	std::vector<int>::iterator	tomatch_end = tomatch_start + last_elem_loc;

	std::vector<int>::iterator	mid_start = in.begin() + (midpoint * group_size);
	std::vector<int>::iterator	mid_end = mid_start + last_elem_loc;

	std::vector<int>::iterator	start_start = in.begin() + (start * group_size);
	std::vector<int>::iterator	start_end = start_start + last_elem_loc;

	std::cout << "Comparing: " << *(tomatch_end) << " and " << *(mid_end) << std::endl;

	if (stop <= start)
		return ((*(tomatch_end) > *(start_end)) ? (start + 1) : start);

	if (*(tomatch_end) == *(mid_end))
		return midpoint + 1;

	if (*(tomatch_end) > *(mid_end))
		return binary_search(in, group_size, which, midpoint + 1, stop);

	return binary_search(in, group_size, which, start, midpoint - 1);
}

void	insert_element(	std::vector<int> &in,
						size_t group_size,
						size_t which,
						size_t elem_filled
					)
{
	size_t	group_num = in.size() / group_size;
	size_t	last_elem_loc = group_size - 1;
	size_t	i;

	std::vector<int>::iterator	chunk_start = in.begin() + (which * group_size);
	std::vector<int>::iterator	last_elem = chunk_start + last_elem_loc;
	std::vector<int>::iterator	chunk_stop = last_elem + 1;
	std::vector<int>::iterator	neg_ones;

	i = binary_search(in, group_size, which, 0, elem_filled);
	if (i >= which)
		return;

	// place padding values
	neg_ones = in.insert(
		in.begin() + (i * group_size),
		group_size,
		-1
	);

	// for (auto start = in.begin(); start != in.end(); ++start)
	// 	std::cout << *(start) << " ";
	// std::cout << std::endl;

	// replace -1s with the real values
	chunk_start = in.begin() + ((which + 1) * group_size);
	chunk_stop =  chunk_start + last_elem_loc + 1;

	// for (auto start = in.begin(); start != in.end(); ++start)
	// 	std::cout << *(start) << " ";
	// std::cout << std::endl;

	std::swap_ranges(
		chunk_start,
		chunk_stop,
		neg_ones
	);

	// for (auto start = in.begin(); start != in.end(); ++start)
	// 	std::cout << *(start) << " ";
	// std::cout << std::endl;

	// remove -1s
	in.erase(
		chunk_start,
		chunk_stop
	);

	// for (auto start = in.begin(); start != in.end(); ++start)
	// 	std::cout << *(start) << " ";
	// std::cout << std::endl << std::endl;
}

int jacobsthal_num_gen(int n)
{
	return ((pow(2, n) - pow(-1, n)) / 3);
}

void	ford_johnson(std::vector<int> &in, size_t group_size, size_t prev_size)
{
	std::size_t	subgroup_size = group_size / 2;
	std::size_t	total_size = prev_size * subgroup_size;

	std::size_t	num_of_groups = (total_size / group_size);
	bool		is_odd = total_size % group_size;
	std::size_t	num_of_subgroups = num_of_groups * 2;
	std::size_t	last_elem_loc = (group_size / 2) - 1;

	std::vector<int>::iterator	last_var;

	std::size_t	first_elem;
	std::size_t	second_elem;

	std::size_t i = 0;

	// std::cout << "Group Size: " << group_size << " Subgroup Size: " << subgroup_size << std::endl;
	// std::cout << "Previous iteration had " << prev_size << " groups" << std::endl;
	// std::cout << "Working with " << total_size << " elements" << std::endl;
	// std::cout << "Number of groups formed: " << num_of_groups << std::endl << std::endl;

	if (!(num_of_groups))
		return;

	while (i < num_of_groups)
	{
		first_elem = i * group_size;
		second_elem = first_elem + (group_size / 2);

		if (in[first_elem + last_elem_loc] > in[second_elem + last_elem_loc])
		{
			std::swap_ranges(
				in.begin() + first_elem,
				in.begin() + second_elem,
				in.begin() + second_elem
			);
		}
		++i;
	}

	ford_johnson(in, group_size * 2, num_of_groups);

	// insert at the start of S the element that was pair with the first and smallest element of S
	// well i mean its already there so :P

	int previous_jacobthal_number = jacobsthal_num_gen(2);
	int	current_jacobthal_number = jacobsthal_num_gen(2);
	int	j_num_idx = 2;
	int	pair_num = 1;
	int	pair_indx = 1;

	bool	odd_numbered = false;

	// insert the remaining elements 
	// TODO: make this use jacobsthal_number
	while (pair_num < num_of_groups)
	{
		std::cout << "Jacob Number: " << current_jacobthal_number << " Index: " << pair_indx << std::endl;
		std::cout << "Inserting Pair No: " << pair_num << std::endl;
		std::cout << "Still have " << num_of_groups << " pairs" << std::endl;
		for (auto start = in.begin(); start != in.end(); ++start)
			std::cout << *(start) << " ";
		std::cout << std::endl;

		insert_element(in, subgroup_size, (odd_numbered)pair_indx, pair_num * 2);
		++pair_num;

		for (auto start = in.begin(); start != in.end(); ++start)
			std::cout << *(start) << " ";
		std::cout << std::endl << "--------" << std::endl;

		--pair_indx;
		if (pair_indx <= previous_jacobthal_number)
		{
			++j_num_idx;
			previous_jacobthal_number = current_jacobthal_number;

			current_jacobthal_number = jacobsthal_num_gen(j_num_idx);
			if (current_jacobthal_number >= num_of_groups)
				current_jacobthal_number = num_of_groups - 1;

			pair_indx = current_jacobthal_number;
			odd_numbered = !odd_numbered;
		}
	}

	if (is_odd)
	{
		// insert the odd one out
		insert_element(in, subgroup_size, prev_size - 1, prev_size - 1);
	}

	// std::cout << "--- End for group " << group_size << " ---" << std::endl << std::endl;
}

void test(std::vector<int> array)
{
	static int test_num;

	++test_num;
	std::cout << "---- Test " << test_num << " ----" << std::endl;

	ford_johnson(array, 2, array.size());

	for (auto start = array.begin(); start != array.end(); ++start)
		std::cout << *(start) << " ";
	std::cout << std::endl;

	bool	ok = true;
	for (auto start = array.begin(); start != (array.end() - 1) ; ++start)
	{
		if (*(start) > *(start + 1))
		{
			std::cerr << "KO" << std::endl;
			std::cerr << "AT: " << *(start) << " AND " << *(start + 1) << std::endl;
			ok = false;
		}
	}
	if (ok)
		std::cerr << "OK" << std::endl;
	std::cout << "---------------------------" << std::endl;
}

// testing purposes and testing purposes only
int main()
{
	// test({65,79,14,27,83,46,62,86,42,56,24,40,51,76,87,89,53,35,73,21,91,10,1,38,82,13,39,92,41,25,18,74,98,61,11,57,75,50,90,64,28,43,30,47,37,94,32,6,26,58,80,52,55,15,60,100,29,95,44,96,3,19,16,70,36,17,49,84,22,63,72,9,2,45,33,8,54,5,34,12,93,69,67,66,20,77,97,78,85,23,31,88,59,81,7,48,68,4,71,99});
	// test({88,8,16,79,51,93,74,43,68,69,4,53,45,60,98,13,77,75,76,18,34,66,59,39,67,37,26,35,25,12,63,97,20,65,50,21,33,61,40,31,32,55,11,95,6,83,81,48,1,17,28,80,96,87,23,30,72,90,91,57,71,89,58,99,3,47,41,49,7,29,54,38,94,22,78,42,52,44,15,85,10,19,56,73,92,86,24,46,62,14,9,5,70,64,27,100,84,2,82,36});
	// test({74,88,98,3,96,77,81,24,46,99,31,35,25,29,76,26,90,62,70,45,80,5,97,72,44,91,28,59,16,36,1,12,75,71,30,92,55,100,66,39,82,18,27,7,17,43,15,51,65,68,8,9,2,89,21,93,19,11,79,37,87,6,56,57,42,10,64,4,34,83,49,60,22,41,73,48,54,50,33,84,85,40,78,13,53,32,61,47,20,52,86,67,94,14,38,23,58,63,69,95});
	test({8,4,1,6,2,5,3,7});
	// test({8,4,15,12,1,13,6,10,9,2,14,5,3,11,7});
	// test({63,51,47,67,3,44,2,27,32,79,15,78,76,66,1,82,33,31,73,16,99,87,95,81,30,7,39,69,59,23,46,70,6,58,57,17,83,20,88,97,49,55,43,22,94,53,61,11,48,41,52,5,35,68,60,91,10,25,9,54,18,86,24,28,65,36,71,19,74,75,29,77,72,40,56,50,21,64,92,98,85,34,45,8,4,90,62,13,89,100,80,93,42,14,26,96,37,84,38,12});
	// test({17,34,32,53,44,79,50,100,96,89,42,37,67,51,22,8,56,18,20,59,98,44,64,74,91,28,74,5,96,52,73,54,25,48,33,12,41,70,65,10,63,45,47,38,99,98,83,49,6,79,40,52,20,94,30,62,14,66,72,33,26,26,21,90,11,12,89,82,87,40,26,41,36,36,35,9,59,81,55,98,15,55,13,43,34,45,13,13,5,69,22,94,33,100,56,22,9,34,60,12,2,56,83,25,70,48,22,10,46,17,22,52,99,35,84,36,30,84,80,83,35,3,49,44,87,88,20,38,30,66,63,20,41,100,30,1,7,17,45,36,91,15,78,51,61,20,28,33,48,43,45,2,70,46,45,44,63,15,40,32,74,41,17,24,16,28,75,48,85,76,51,20,30,49,54,50,63,25,76,87,31,41,34,70,2,8,47,92,31,45,92,98,4,45,79,39,22,42,88,62,56,30,6,18,22,68,11,64,33,5,53,32,49});
	// test({48,369,411,39,438,277,481,188,447,462,145,3,50,401,487,91,437,43,106,44,40,381,14,151,132,195,180,153,22,118,103,281,361,475,259,422,208,102,210,456,480,17,344,420,445,461,42,477,136,152,215,209,217,69,338,116,166,155,158,193,73,387,16,191,185,31,365,271,319,334,104,384,497,483,431,333,347,13,261,65,320,276,70,425,440,27,296,6,448,455,56,316,457,200,326,74,142,105,372,312,407,350,376,51,18,87,85,496,417,288,371,329,226,385,495,203,168,348,474,84,101,80,468,86,192,357,453,225,100,292,426,4,451,72,345,469,427,382,290,184,402,498,123,7,366,370,57,479,64,216,61,424,117,351,321,71,218,75,242,170,206,113,204,212,232,173,310,134,389,182,435,248,68,336,410,147,415,355,76,419,373,205,29,47,222,362,36,405,244,122,313,375,224,286,306,397,172,386,360,250,211,282,267,317,304,121,58,446,159,394,380,54,238,305,249,171,253,339,460,364,194,409,298,325,482,202,400,150,315,284,67,10,324,129,196,251,340,499,127,390,311,66,308,459,144,81,236,190,263,434,92,2,140,396,24,115,21,46,383,35,429,472,221,135,443,458,79,467,20,237,269,219,178,391,274,283,332,63,464,486,441,255,52,278,489,95,352,287,49,148,154,270,266,130,327,165,53,143,300,230,294,55,59,303,164,214,432,146,1,254,354,416,436,235,107,388,231,299,186,5,169,356,207,264,26,465,398,430,8,322,89,291,157,138,124,60,88,187,337,257,328,265,223,247,343,256,335,374,358,421,444,83,11,378,189,176,406,423,19,156,111,473,133,243,229,201,139,110,45,268,484,470,301,368,120,240,392,439,213,408,492,488,463,280,478,246,452,309,295,93,399,109,227,96,293,318,99,367,161,449,412,450,234,126,491,137,418,241,404,90,239,454,62,228,199,108,359,141,28,12,9,94,34,181,252,82,342,490,285,41,175,167,77,466,23,494,272,279,353,131,471,233,128,500,78,297,331,179,98,330,428,97,302,493,149,341,314,258,177,403,125,25,198,485,349,30,323,393,119,476,413,377,346,220,307,433,414,160,260,32,162,112,15,38,245,442,174,363,163,33,379,289,37,275,262,183,114,273,395,197});
	// test({596,93,666,352,346,445,629,655,527,240,373,274,163,288,402,205,3,308,693,567,313,434,298,316,53,588,264,431,671,33,496,475,458,358,563,672,258,60,525,121,239,426,95,200,680,246,75,173,676,440,281,614,501,158,379,669,197,388,416,487,338,383,396,7,577,48,275,24,305,109,520,443,682,545,141,688,296,40,683,249,176,542,76,212,208,165,646,8,370,45,292,62,27,41,395,572,241,488,406,92,64,372,107,597,540,699,185,98,397,401,512,359,592,664,422,471,602,88,116,202,375,685,123,291,91,273,403,4,632,511,565,235,128,424,468,168,276,199,456,584,473,28,82,306,631,100,382,586,651,630,515,420,566,400,38,260,503,253,325,314,133,590,564,268,46,320,196,657,472,105,96,283,23,152,640,568,575,432,112,144,247,342,69,334,80,150,539,485,162,143,620,687,652,692,405,56,304,509,549,555,186,254,277,192,81,131,638,521,677,138,201,108,605,248,624,129,127,119,470,583,623,12,492,639,231,439,469,317,573,558,217,174,74,587,650,183,15,293,332,37,349,490,215,554,261,610,497,548,613,648,310,571,579,392,190,58,393,691,526,636,279,159,625,285,690,442,124,593,178,220,318,419,601,147,695,476,263,136,117,477,451,142,427,556,52,175,562,226,209,353,696,259,130,160,536,505,569,493,611,300,659,387,694,385,26,576,380,618,154,461,166,600,450,321,681,5,10,2,641,126,463,480,324,262,531,155,663,289,684,287,243,452,330,362,30,114,323,621,280,16,180,106,77,486,491,146,250,148,266,223,331,269,181,635,63,65,191,609,381,394,344,599,529,581,603,608,233,574,17,506,79,35,355,228,551,446,22,408,435,225,294,541,194,59,14,457,242,177,634,414,465,523,398,61,479,535,169,339,552,354,25,510,412,221,270,245,647,544,257,188,484,348,140,83,255,460,665,171,350,122,244,538,532,447,229,674,167,361,697,616,87,582,628,309,436,182,418,644,667,617,89,498,433,57,227,42,656,518,13,120,94,462,661,454,626,164,31,34,478,210,550,51,519,619,9,234,483,340,265,290,67,236,118,19,591,399,530,237,328,678,612,102,222,301,660,543,459,336,645,184,295,135,425,132,256,364,411,284,286,481,668,508,90,213,363,271,428,6,97,20,524,319,326,504,50,378,189,570,448,516,430,421,195,21,125,115,72,658,489,622,219,437,377,441,315,137,698,99,70,278,343,211,134,54,585,232,85,47,627,367,662,110,1,580,386,689,561,360,429,145,151,113,595,299,156,272,499,409,513,345,675,384,29,495,466,438,49,322,303,453,198,32,187,578,517,267,553,653,214,157,251,368,371,598,607,415,673,528,84,455,369,547,297,193,335,252,537,218,534,502,73,514,637,533,474,410,615,71,482,679,44,560,389,413,423,161,494,18,606,390,78,366,172,327,216,206,604,357,365,643,302,700,347,66,449,86,43,467,104,224,333,311,307,204,654,179,407,203,557,649,312,55,68,139,207,507,374,39,101,282,337,153,230,546,670,404,356,686,464,238,594,417,351,522,170,444,341,11,376,642,589,500,633,36,111,103,149,391,559,329});
	// test({903,576,2,271,472,298,105,876,212,674,694,39,124,130,404,46,897,126,660,556,796,732,639,275,158,227,921,444,216,102,579,837,673,63,181,135,633,362,170,36,163,797,291,161,518,300,816,471,932,543,924,321,452,182,604,775,295,16,895,532,228,389,458,91,490,11,529,41,719,453,122,821,223,757,863,147,108,455,899,325,740,284,729,201,173,72,841,879,656,343,870,363,938,88,338,346,232,511,352,831,935,160,230,344,836,9,678,13,540,499,32,413,864,259,669,462,273,793,551,613,424,913,177,237,690,759,7,96,143,183,400,866,599,717,324,817,798,844,464,578,514,199,70,494,217,316,515,103,66,309,659,283,862,914,936,755,355,433,469,45,349,724,116,908,119,44,71,620,716,770,769,888,858,554,221,696,15,244,684,432,399,517,440,950,248,496,693,296,446,487,749,927,305,489,804,120,672,810,337,628,274,302,414,42,851,781,28,625,266,692,835,429,760,818,282,118,306,718,838,491,521,30,198,901,951,893,872,263,539,420,376,875,139,150,524,943,758,64,544,172,832,238,249,933,191,848,386,155,670,430,128,906,29,874,110,813,286,391,852,403,267,624,54,638,880,167,545,597,833,527,676,307,50,812,726,5,68,711,319,510,111,593,761,261,219,61,385,485,605,649,210,497,940,285,654,502,37,56,205,886,280,559,616,4,845,220,460,422,189,488,140,580,661,209,187,482,235,609,504,347,765,133,846,555,193,322,450,92,323,873,699,709,6,522,69,59,65,855,486,320,269,246,912,815,293,144,523,735,162,457,43,81,463,380,369,87,952,795,632,459,396,451,208,195,834,166,159,910,823,528,725,272,714,811,928,944,702,276,213,664,351,621,479,822,174,843,402,685,438,95,891,76,553,773,867,780,571,365,763,478,708,247,99,918,636,819,48,169,794,336,849,537,73,243,549,643,922,57,791,808,634,854,668,340,869,937,681,803,750,194,814,601,519,923,767,900,476,35,884,378,667,254,683,113,657,112,541,618,930,390,356,461,388,145,839,631,588,945,577,415,608,662,589,270,250,954,827,663,737,268,354,292,353,141,550,154,67,428,411,733,434,310,627,190,687,882,949,445,802,60,568,947,180,917,98,443,260,117,370,77,830,953,226,100,700,333,790,806,645,650,484,175,79,304,287,764,25,598,564,552,207,392,257,701,483,902,772,506,857,251,256,792,358,508,894,397,563,203,401,703,825,493,698,829,229,915,465,675,335,334,348,547,85,86,637,747,435,941,641,101,94,339,512,889,97,558,381,695,176,106,646,394,574,127,492,474,361,743,619,826,186,315,345,27,739,572,753,477,805,373,776,442,534,525,779,617,82,367,561,503,828,107,371,38,635,1,80,58,329,200,218,560,303,214,192,253,197,679,330,655,426,905,375,800,314,946,24,592,47,738,364,26,245,109,83,240,509,809,326,691,406,22,425,383,909,531,448,658,123,436,233,585,671,520,538,121,630,74,653,644,239,332,51,252,861,441,706,567,622,416,129,610,178,75,264,569,500,184,871,596,387,842,366,546,196,907,939,281,736,55,62,931,148,892,586,294,313,473,410,290,614,715,418,594,149,156,784,748,368,279,423,582,734,341,242,911,762,12,407,535,741,90,498,468,516,40,157,542,262,377,920,277,427,202,372,255,151,142,742,501,93,185,475,682,301,919,789,49,447,164,417,382,206,19,171,331,278,595,680,34,768,327,431,754,393,697,215,299,868,847,234,600,777,456,782,581,23,557,419,704,52,17,265,602,507,114,470,165,8,705,707,495,297,883,225,689,929,722,752,18,153,850,648,607,926,713,615,744,925,374,840,565,412,612,439,591,720,859,125,138,651,308,904,513,548,746,727,408,241,856,318,168,723,480,84,786,405,437,31,783,730,853,751,731,942,688,78,710,3,530,587,665,466,134,562,131,104,454,146,570,712,896,766,357,312,222,224,778,342,311,533,14,583,652,677,350,481,603,606,860,623,878,409,785,745,467,449,611,379,360,865,642,536,801,771,398,647,179,728,666,136,33,566,573,887,885,584,877,53,590,288,204,421,626,505,756,20,807,289,395,788,258,898,89,948,132,575,774,317,824,231,629,21,328,916,10,359,890,799,188,721,934,211,137,384,820,686,115,787,526,152,881,640,236});
	// test({138,327,693,1089,940,94,554,1055,370,571,172,390,810,152,205,298,1527,1443,200,973,169,423,416,1323,536,1225,1071,975,213,1393,743,522,1156,257,617,1230,1538,1280,1190,86,673,430,892,1177,825,438,1521,1539,1161,1132,876,903,166,1532,1306,1046,1550,379,712,11,165,240,470,978,482,1014,468,550,156,504,1238,170,514,1414,1510,234,1543,1433,687,1363,830,1416,1319,155,923,1184,1434,526,453,924,1388,736,565,1111,929,735,1083,163,1549,616,1480,1200,655,1016,260,241,1441,658,87,278,1364,1176,221,1060,842,1186,535,607,1307,698,715,80,859,273,161,400,53,1126,206,281,113,1170,931,1472,1065,115,7,410,547,834,419,1236,898,772,307,442,542,1554,1489,15,157,488,374,1074,73,1045,720,587,1296,1324,160,567,1157,870,277,540,1351,1399,1268,225,325,755,301,107,844,1366,360,781,217,355,913,933,435,49,824,936,608,1242,796,538,699,788,1002,1043,47,328,1131,1143,1394,1514,836,1097,1278,645,851,541,1136,48,372,248,326,1227,181,334,1370,8,384,1256,707,1067,1341,1378,190,719,413,963,827,958,75,1274,330,1158,12,1470,1019,614,549,274,137,144,934,1166,1373,451,946,662,1506,1299,139,452,901,708,149,6,1430,158,761,215,626,1365,1246,68,229,954,294,1247,1149,732,1404,174,528,996,577,966,57,394,779,300,907,941,1456,746,1483,21,129,1359,1437,1518,1255,24,1267,299,434,191,321,716,1329,758,964,726,808,337,93,1261,1103,1195,125,1098,1070,216,660,904,283,76,1466,968,863,559,1304,37,656,588,894,36,970,695,84,1279,1152,175,1511,1352,176,510,1075,980,885,285,154,872,625,1169,153,356,45,338,82,791,764,727,1460,1313,383,1284,1285,78,151,1545,629,910,187,508,1294,1429,389,1228,835,212,463,380,804,627,211,1487,1203,117,1011,877,897,1490,959,146,219,989,1540,56,854,1133,1492,1455,455,1513,1440,220,711,945,937,602,425,1355,1012,353,183,305,450,331,905,1293,1144,1233,748,1102,71,1410,1039,474,454,1137,22,850,214,944,1322,819,140,1526,116,1123,1469,1357,315,606,1121,1063,1377,1107,445,295,530,426,1425,411,203,1088,406,280,709,925,1034,972,1392,1537,846,857,988,1548,1531,1412,987,202,671,1465,1485,1085,1165,14,500,840,902,801,652,1508,1289,789,757,382,744,867,598,805,135,986,1529,1390,476,723,317,531,464,529,1163,407,106,136,644,319,1106,1340,415,794,1167,224,58,1130,677,471,1277,909,799,769,1199,1211,783,373,793,499,519,66,1004,1129,575,1049,1110,1348,263,630,52,1189,286,1096,267,1346,599,421,683,1248,189,120,750,1292,436,497,409,253,1449,1417,670,984,1040,1057,231,269,18,2,847,302,1350,1000,688,891,790,243,1036,50,631,1401,563,911,386,1193,443,994,869,1241,1112,81,800,422,83,814,553,201,1025,1505,141,622,490,1257,912,1298,767,591,1356,465,696,1338,34,552,432,1069,634,1044,828,792,1066,46,928,95,1175,122,1321,806,1188,822,1243,1461,971,333,26,579,1426,1544,620,100,261,601,33,1403,1520,97,589,943,1104,131,1327,572,366,1303,713,856,43,491,1222,920,1202,92,72,458,150,168,638,85,192,473,292,1474,568,766,1139,1536,209,818,595,865,765,1266,481,1431,252,369,469,1535,778,388,665,1079,270,597,1368,111,942,1464,689,1009,935,352,1397,74,1407,1413,1162,1533,883,1054,612,1419,392,259,594,666,1249,109,414,985,188,1452,809,1018,173,1387,62,1181,1263,1080,96,13,1010,1462,648,949,1534,346,525,110,51,1173,1101,503,1240,1,1122,1276,1148,472,860,210,659,495,1367,1105,1442,1264,167,816,255,467,999,667,990,130,242,680,888,1024,734,664,786,1331,293,832,537,878,1361,1216,397,647,1495,254,1435,512,65,329,1411,873,1308,335,775,197,127,1206,1498,1234,105,1260,1084,1028,1547,578,977,717,1007,1553,494,1353,1369,501,223,838,179,1439,1231,124,336,354,1134,91,381,884,776,1153,185,90,916,1343,752,604,1015,1302,339,890,1380,402,798,35,1182,251,807,393,520,5,1094,1406,1201,247,728,706,1048,264,1209,266,1317,821,1446,1457,574,287,428,98,54,704,957,997,1528,570,953,823,1478,939,654,1218,1224,1239,1468,637,672,1245,773,308,207,874,560,1347,1210,69,148,1030,1515,1501,951,162,1423,1427,222,624,112,927,1372,1051,615,960,387,669,1185,1335,1436,611,357,1376,511,142,385,1032,1458,1178,340,417,289,403,1174,1349,1333,186,592,896,1503,444,759,692,344,900,104,61,1031,498,108,121,1077,826,271,1151,1328,391,399,829,820,1159,1087,1400,461,724,178,998,855,875,517,31,1172,306,368,198,439,952,1095,502,55,581,795,1187,1542,1273,1171,1325,555,9,79,249,780,686,948,889,1398,1339,1235,731,1358,1147,1415,753,813,268,1330,1291,1389,1128,297,947,496,657,811,1099,509,1180,1125,714,700,420,576,1093,431,518,702,1445,180,739,1454,551,1262,1003,956,961,610,405,1450,318,1371,802,233,133,636,1418,1310,584,585,3,679,661,118,784,1315,1082,1062,134,1250,1221,16,849,475,1023,245,362,505,564,196,323,1295,309,768,1100,741,515,347,1253,376,558,1033,1318,1013,1155,1090,1551,1140,1115,171,974,1476,1444,244,950,1408,480,123,1502,1300,979,275,1017,276,367,447,1342,446,1037,485,751,1198,77,864,628,605,1022,1316,1208,917,774,358,609,642,1320,396,290,845,230,839,730,312,1026,126,545,1145,983,1451,649,1448,1183,797,1092,858,1432,663,837,1287,600,1073,296,1428,314,30,603,785,114,1197,882,782,1504,1516,1029,1517,1438,404,345,705,492,982,1212,848,1396,1041,1286,703,740,460,320,457,678,1281,1524,1109,1223,1496,371,194,1362,1135,67,930,1270,879,938,433,771,1336,651,866,246,1068,1525,351,304,1196,1042,284,1497,1058,102,1471,377,20,1282,1064,440,967,1259,976,725,1005,1482,424,682,650,621,1050,236,25,310,204,1290,1192,487,324,343,1512,919,770,483,408,1541,1035,527,103,701,1395,1021,1382,1481,1381,721,1053,1374,684,486,653,674,899,311,1001,880,1265,1522,199,459,533,143,580,1217,1473,239,1385,1047,871,1391,429,1493,238,681,843,1117,1375,1052,1509,841,1354,32,1142,128,556,646,926,1154,887,164,729,619,868,991,562,1150,675,1226,852,1477,965,232,29,738,1283,812,548,1141,641,915,448,441,44,412,691,235,258,569,543,803,184,1409,1215,1484,342,375,291,1500,685,1271,861,88,1360,1179,1113,992,742,1091,754,1312,1205,1006,831,89,493,521,539,747,147,70,922,99,1552,722,288,1232,618,227,633,918,561,332,1288,456,449,513,1424,1447,265,1072,546,361,1258,921,932,523,1164,63,881,893,862,690,1020,1301,749,1254,1118,1463,639,272,623,1168,1405,1499,737,697,1519,1422,282,1237,534,401,635,365,218,1402,479,23,1114,1213,1229,195,969,1379,1038,787,132,1305,1061,484,1386,590,378,1086,350,544,119,322,364,1494,145,17,817,303,59,363,668,477,1059,1191,27,762,1214,159,815,1127,1383,1420,41,777,1326,981,1530,1204,694,226,1207,1124,516,632,1453,1160,1546,462,279,1334,908,524,1269,466,886,1194,582,1345,1297,1311,507,506,583,250,1244,437,39,489,1507,1119,395,593,1475,1337,1138,1486,1491,1344,573,398,313,1384,833,1479,1219,756,1252,1272,962,557,101,1332,1008,262,1120,745,1056,208,906,710,993,64,1076,478,42,4,566,1275,1309,676,1488,1459,1251,1081,1467,643,640,28,1116,256,228,1314,193,237,760,19,1146,1078,341,177,1523,427,914,1220,763,40,349,895,182,532,596,1108,10,718,359,613,316,733,38,1421,853,1027,348,418,995,60,586,955});
	// test({3794,3183,1112,1572,3411,584,4732,2585,2502,3242,459,1361,2713,1122,75,3609,4597,4616,4927,1970,1897,1,594,4777,3260,1493,664,1710,3969,2919,3106,3212,2188,2580,1079,1402,4216,2926,1312,2871,2770,2829,4335,2709,1477,2383,2067,3447,2987,3047,20,1139,2050,417,1542,2378,1182,2159,993,4311,2861,4368,4835,2804,1041,1920,498,2773,2265,4326,614,1167,748,3999,4182,716,777,1398,1965,412,4669,2941,700,1307,4306,5120,3329,2757,4142,3022,4694,521,89,4229,4352,2052,2633,213,3430,137,290,2951,895,4718,1027,4088,4249,1514,1353,2737,1136,3835,1263,1385,1374,3274,737,3912,3892,4217,3779,191,4799,150,165,1562,3208,192,4836,182,195,1431,4450,1926,3746,4782,2730,1099,4880,2839,3075,2093,2974,2157,1596,3420,33,319,5057,4502,1052,3042,444,649,4456,1581,3891,133,4008,2269,4767,2440,2821,134,3371,2752,3854,2877,429,4584,1386,3431,2991,1722,5101,3655,2457,2846,3011,2425,5013,1868,3450,1097,2387,223,1565,3085,1851,1128,810,3534,3955,1843,2091,1217,3663,3012,2986,500,1803,1733,675,983,102,4651,2899,2712,2996,782,668,3929,2637,1779,4948,558,3643,2255,4074,910,4832,667,1176,4259,5063,2522,3647,4485,661,1215,4139,1051,2453,295,1407,81,1802,552,2745,3441,942,4059,930,144,1643,1042,4289,643,3993,653,1705,4973,482,1363,3723,1847,4807,1716,3705,1445,4890,601,961,1148,2362,4156,998,5049,1876,3919,1113,4246,2010,103,4058,573,136,1016,4127,2484,2402,4108,3311,1274,3123,1306,4471,3096,762,571,5122,616,2228,652,2183,1035,3939,2347,967,196,216,1724,2515,3714,3250,3602,4761,3129,2351,4073,1495,3987,3725,4030,2586,3621,1519,4260,4770,855,3458,1491,2350,2841,4575,2103,120,3516,920,1511,2214,1106,2147,1721,237,2170,4691,4743,4556,313,3076,1102,4797,2089,1556,3313,595,4111,282,2098,2179,775,2598,2077,4613,4468,1054,1131,1714,206,3559,2697,2099,5050,1656,3251,3151,747,2014,2588,145,3314,4827,4029,3436,4670,2994,3419,2247,2308,2892,3844,2952,3823,4004,2590,4263,1210,1538,66,1391,934,3817,2848,3533,3446,2604,1930,2554,1530,3389,506,3461,3962,1471,4016,1497,3438,3707,1915,2438,4826,1681,3380,3235,1436,1063,2958,1468,100,3067,522,219,935,1475,793,406,3928,3071,140,2417,1856,3576,3506,2776,5055,3347,570,38,2897,3475,3795,1140,759,1640,3089,3083,4377,931,3491,1610,1223,461,3135,881,2759,370,610,1962,1648,1187,4892,331,3412,960,2967,2911,1221,3131,4884,3000,1834,2148,1663,1064,3601,3500,746,1428,96,5110,3613,4163,1278,4844,4114,2290,4704,641,494,1923,846,4812,3059,2971,1291,3490,4645,3196,68,2686,4524,3455,3976,1422,3497,673,4431,3064,323,4877,1974,2125,815,1600,1474,1004,340,3530,4192,3226,4467,3846,1088,4395,4295,1548,4742,4207,3323,4140,2879,3766,2933,2487,4933,3585,4357,1389,4067,3525,238,4519,2562,4426,88,3437,4731,3574,820,853,4632,2747,575,2577,1602,4072,1845,4319,1013,4900,3026,271,3300,3599,2135,1207,29,3257,536,2769,2154,2689,2583,2812,4057,2579,1048,1420,2552,2774,4100,2707,4107,3762,3807,3724,2843,5109,3008,2386,1047,2421,158,2094,254,1118,339,4080,2042,419,2966,2030,2731,2288,4585,3175,4317,3082,3330,2415,3551,3465,1742,1796,1968,3004,1981,3451,187,3182,2056,2411,2543,1896,3079,4555,2367,3294,64,581,946,2516,658,2567,3244,1604,3563,4907,542,2696,129,1554,3526,1635,4529,1671,540,2235,2828,131,871,2057,4251,293,4564,5087,1119,2321,717,2749,3,2326,2710,1244,2291,1332,3594,898,2719,483,230,3459,4253,4466,39,1421,4714,2975,3427,569,4864,2643,3547,2358,1459,1846,3203,4425,3569,4763,3028,2249,1953,1550,3339,1197,2781,178,9,281,2129,3555,3283,2530,5054,3369,5045,2691,2985,557,3206,4932,3273,897,2295,3365,65,2836,2632,4388,3742,3077,1092,315,4177,3703,3390,2935,1380,3890,463,663,4419,2276,1976,5078,1662,4244,1286,1264,3352,1423,4625,3829,377,722,2645,2771,1053,1620,2777,2708,3246,2639,1452,4986,2842,3781,4045,1558,3097,1912,3924,1333,3859,1503,3871,3842,1789,423,1830,1202,1070,1541,3484,465,4012,4981,3546,3878,2000,980,2371,3422,292,5040,4571,2939,848,393,4147,4576,646,4626,2055,1653,3297,286,4331,3385,2097,2261,1520,1272,3265,682,462,3326,3107,2845,3832,997,3402,3014,2526,480,1085,2811,1427,1634,3961,4193,267,170,172,268,2199,4334,1270,407,4358,909,1595,3557,4587,4928,3271,1849,973,3847,4443,1869,4594,2801,3049,2537,938,4762,3015,568,1592,1162,4654,4671,4364,3485,3188,2891,1303,2898,3384,3399,2675,1193,4372,4076,4449,2603,2360,3990,3155,21,2902,3237,3117,1527,2808,1373,1008,677,2032,591,1810,4191,4631,896,1254,2069,5016,4428,4330,2529,2172,410,4562,116,3508,2403,1956,3245,1526,283,4991,4922,3048,15,2086,53,2834,1908,3396,2547,3758,3713,504,2324,4698,515,3290,2396,4617,5111,1615,996,2338,1755,1925,4397,3865,2374,2058,958,3759,2404,4595,4893,59,3587,2274,3210,13,3428,3693,1828,4023,4715,256,1482,325,1756,631,55,121,1061,953,4708,3418,358,3897,1889,3448,1782,2303,3755,2109,1248,2596,1777,2485,4710,2802,1961,5037,467,923,3967,954,1505,1708,3046,1751,3925,2978,4766,4254,4547,3732,1432,299,644,2001,3863,3593,3752,4923,2959,1154,4878,4557,1605,1947,1185,2681,147,1439,1811,4792,3124,1707,918,5061,2110,3202,831,4320,537,2805,3425,1704,431,2742,3468,4248,475,2888,3102,4533,4790,1823,4155,847,4174,4889,1321,1134,2744,17,1219,2245,2738,3704,1269,5018,821,2766,3519,1792,1534,3810,4350,2553,4513,2304,2142,589,4172,296,25,74,3001,687,4759,5085,3710,3084,662,4313,1124,11,399,1006,2322,4169,4589,2527,2448,3824,2025,1300,4773,2779,3607,4855,3769,3843,3972,1817,669,1706,1617,2564,866,2890,2426,2981,2375,1693,2221,992,232,4463,830,4069,1613,2616,2038,4208,3888,4682,4702,4535,1919,3706,1083,1464,4376,4662,2599,2938,1814,2101,4068,674,1165,2202,4779,4283,76,2873,287,3640,872,1446,67,1741,2520,5005,4243,1026,4141,837,2450,2664,1797,2389,2454,3605,1687,2357,4415,4849,3513,1892,940,291,1302,972,3809,1318,4970,1864,1072,1650,559,2346,2925,3281,3359,945,703,807,4590,2513,1881,3901,3440,5076,632,3856,2336,4604,3160,2162,1844,3467,394,1678,3675,4734,2243,1762,1642,334,692,3949,621,2340,3830,4277,3668,5002,1879,949,2905,4351,4608,2823,1727,1564,3010,3617,3341,4079,4503,4181,2659,2128,3681,666,1138,138,4896,3589,1841,4033,590,3944,2767,4165,1235,4121,301,3038,3645,606,4537,225,3745,3207,1840,2854,1203,3837,1515,5029,1861,2171,950,2551,125,839,4568,755,2825,4924,3282,2495,3464,1584,3191,2914,175,2627,1967,4919,2309,3532,4600,4823,4255,3142,4842,1280,4592,743,4087,28,420,1894,4876,3994,3894,3224,1940,3136,1805,3258,637,4966,883,3194,1683,2900,3658,2161,3249,645,2186,986,2447,1963,30,3280,352,580,2878,2218,1205,263,4262,4946,5033,4396,2236,4135,427,2818,1750,861,126,4271,4987,3626,683,4416,772,1005,714,1749,2019,1082,4039,4737,1044,2211,1872,1014,1629,3682,2518,3157,711,1670,4687,2168,619,1192,4551,1371,1379,385,408,4221,605,4879,2059,1330,5,4134,5065,3813,1545,4581,3507,4276,3815,4209,1878,634,4256,4605,2111,3927,471,1552,2430,1513,2315,4602,588,4912,1824,1747,247,5019,974,2120,4153,2610,5003,1885,1641,4498,3139,2858,1725,1800,4137,549,2007,4553,2682,2063,2045,2702,4870,908,4270,4363,3021,1544,2957,3975,2581,1695,2173,1575,4304,1583,2373,4914,1867,4337,2775,3774,4992,2034,2657,3877,2486,3109,2999,2392,445,1984,3512,1430,4910,3983,149,1336,2166,1007,4200,304,1621,2328,578,3453,2647,2963,1028,3159,3677,1978,2918,4154,2695,5000,1729,124,4623,3145,4312,1809,108,4099,23,4577,2889,1335,3921,4332,4606,2612,3926,4796,2136,2717,1237,3509,3886,510,659,3638,1186,2167,3310,4747,1057,2874,4542,1665,774,1191,4548,2423,4999,508,5006,776,2954,1282,3173,2227,94,3651,2556,1233,2078,152,4952,4198,2706,264,3423,4403,4978,2482,1159,3678,1440,4634,16,1400,4993,1860,1740,827,3116,4390,1242,1172,3141,341,3960,2656,2153,1927,3317,4937,3740,2312,4143,4336,3104,4711,562,2830,4599,1969,2156,4673,3417,4505,4783,4158,4627,1320,5015,547,1343,226,1284,524,892,3381,4703,5105,3070,859,63,3147,2988,446,3896,4785,1690,4252,3169,603,1405,3305,2602,1208,4327,376,4440,3998,2377,1652,4472,3394,2102,2370,1196,294,3642,3548,1308,3997,392,4407,3162,2467,647,1346,1298,5108,4233,4451,4003,503,4002,1585,3236,1216,2287,2725,2740,1626,5104,5073,3293,1616,2561,1339,2076,3932,4168,4038,1531,3040,101,442,862,2847,4109,764,4781,1639,1229,4650,2241,2139,3122,4738,1225,4148,355,166,5116,1766,2519,157,3537,4573,1218,1001,2012,1247,4091,4523,822,2428,1826,1133,3661,4746,3538,2763,3349,3495,4821,2306,4939,2646,3931,284,5098,1866,3536,844,808,1859,698,2234,906,1367,486,1476,4380,3165,3496,4399,2451,3058,2568,2003,551,4593,4858,2796,3181,3874,1316,2345,2118,4096,4464,2264,1175,2772,3915,4786,1701,1533,3034,4430,773,104,907,2344,3571,887,533,1664,4339,3792,1160,3654,4310,2494,4713,3308,612,4084,4027,2280,1499,5092,1913,3636,3220,1090,4684,3322,1130,2618,602,2624,4772,1781,3333,567,250,2698,1419,3343,4811,3134,3043,386,3956,3798,4873,4945,1769,628,1982,2746,3386,718,3761,80,3092,4506,1624,3505,4063,1170,3880,4007,489,426,3462,586,1429,4760,1295,583,414,2023,1884,2250,4303,2636,222,3024,2570,4630,3596,3177,3149,528,1852,3697,2122,4496,4706,4188,1614,1910,3808,4700,4019,2609,751,277,2721,965,3272,3337,1808,1351,2849,3735,2625,1164,4423,2361,4787,4629,1381,1964,3692,210,3902,3615,1152,3650,289,5107,4435,1557,3432,367,2195,3284,727,1601,3027,876,266,4800,2323,70,626,2189,1163,3410,2182,1392,1546,545,4491,153,548,3503,61,5026,3575,3922,3439,2748,928,2542,784,2886,371,1933,620,2680,4238,3876,2397,4692,4374,3312,1157,1425,1344,4902,4867,3565,4846,2223,2187,1682,343,4949,3652,3095,3700,1129,2441,1024,4955,3098,3039,4994,676,333,736,4480,4495,3680,3597,3951,1268,32,235,1812,4964,2240,433,1434,4538,2509,2483,957,4752,3521,448,2246,3855,648,2754,4822,1863,2016,4187,4847,452,270,4420,2559,2785,3734,3211,2496,2950,1394,5064,1517,828,816,4205,2068,1466,4875,220,3088,4090,3069,2803,2082,2279,3517,3364,62,3603,1168,3523,5056,4447,1108,1404,4349,4065,4895,4001,2699,4146,4410,4175,338,1818,1697,4816,5083,3213,1311,4129,4301,3456,1833,3115,4977,1711,3033,742,507,2993,2381,3698,912,2137,2412,3388,279,214,985,4321,1576,1655,5094,2565,753,5071,1547,1571,2726,35,4658,212,3355,785,234,3398,5072,3156,215,1907,252,2844,2119,672,3087,2469,2,2145,2210,4104,850,2885,5113,1382,4044,2536,2541,1644,2789,4696,3003,693,4998,3373,4105,3590,1238,833,2650,3306,2884,1999,4515,251,3522,387,5024,1651,4619,4648,1979,1775,2070,3964,608,2641,3105,2282,3527,1101,4833,1535,695,1778,3966,4314,4868,1489,1658,3860,4046,2275,1928,4586,2144,4371,52,719,4418,3397,622,3812,3395,418,2917,3666,200,4178,3471,4954,1325,3421,1561,4469,2838,1356,4118,3299,1986,3656,2393,1260,526,2442,4957,1123,1801,2872,110,2835,670,929,2475,4460,1362,5102,1855,1901,3806,2715,269,3729,4050,5070,1770,766,3736,4273,3765,1086,2021,2225,3572,2947,2649,1582,801,3013,3113,2356,1190,1895,4166,5004,1746,4657,732,1222,2815,1406,2343,702,1758,624,309,2887,4951,1020,2398,3405,2146,2955,4218,3739,3285,1525,1555,95,1453,735,756,5095,3278,2444,2408,2674,3020,4367,4018,1567,1100,3477,1875,4885,1273,2176,1350,4967,1628,4232,2281,4549,4641,1487,2382,516,2054,886,4476,3093,2716,2334,3391,202,5012,3127,2827,684,1937,3971,3728,2127,1632,4677,3247,4071,2593,314,671,2722,4886,3982,4719,5031,2286,3754,1768,1516,1921,1966,3487,1009,1909,117,1603,1764,963,1906,3852,3937,3827,800,4082,4101,1117,3193,4666,91,3610,443,3307,3457,3345,858,2595,7,4793,3463,3168,2429,3489,244,3549,1760,2983,2670,1717,1171,3584,1414,3154,2734,3324,1893,2284,3072,4685,2591,1709,3353,2517,361,3933,1236,4017,4802,2165,1752,640,868,1224,1990,2786,453,1991,4507,4926,4234,2739,3940,2601,176,2906,1209,600,2216,4408,1115,2233,3989,3379,2149,4131,4554,749,3234,2043,3667,2217,633,4086,733,4598,8,4659,1631,3995,2768,3717,4308,1283,2126,3657,3718,1606,1180,260,517,4950,4197,4755,1087,3580,4544,3541,2937,741,2035,3957,1433,2833,2479,2693,3608,3679,1638,4005,2062,354,4862,900,2458,1204,788,205,382,303,3445,327,914,745,3946,3374,4328,3588,1744,4729,425,1142,1996,932,712,3166,1111,1793,2113,2508,3103,4643,2332,3032,1850,2065,384,2630,40,1689,3060,3775,4341,3867,3167,4492,596,1917,5096,955,2329,2584,2277,625,1348,265,476,2115,1900,4504,4275,2278,2856,2036,4497,3920,4040,4034,3631,4316,4,4887,1832,217,4982,4022,991,2075,3426,2862,5106,308,2549,1591,1462,4138,4988,262,2705,520,3639,3041,3600,1305,1265,4272,2301,685,3144,5121,1788,3893,4261,3727,329,1232,4881,729,1029,1932,2582,47,4144,5044,1093,2732,1120,5090,2388,402,1536,708,3978,1696,2619,4031,422,5117,3178,86,3472,4639,421,2204,3653,2492,529,975,4958,193,4028,239,4060,4920,4346,2258,4375,481,4699,3917,3125,4092,4173,4726,1873,3737,2252,4387,3550,2433,2085,209,1143,4969,3899,1934,4801,4874,34,4264,4859,754,2678,4037,4739,4345,1023,1597,2083,3376,3632,1342,4324,4223,4908,4717,4185,1838,58,4911,2629,3479,4974,4026,4413,761,5075,655,948,115,4795,4935,2894,1448,654,4365,428,1625,1409,3598,4258,113,3037,2920,3918,496,1126,1490,4274,97,221,1103,3719,2658,851,1183,2540,5088,4580,3474,310,1393,1094,3478,3433,1292,976,183,2020,3701,1066,1267,1522,3630,4242,3184,2948,3152,4647,2512,2640,2617,4355,3327,4412,546,162,4805,1137,2724,781,4361,4824,4527,2071,123,770,2152,1618,5053,379,99,4151,2701,3050,2895,4014,1372,1415,1469,2720,1198,1327,2569,1553,2840,2934,1473,2944,3413,2376,1880,1608,2973,3268,2124,3502,2348,1366,3907,2215,3670,484,1496,3476,1589,4297,4501,4663,1804,396,1657,4897,3782,353,438,4915,2468,4934,3204,2501,805,4837,2743,657,4921,1630,4453,3063,680,5103,1822,397,54,248,3501,5100,4421,2679,3709,3086,2220,5099,3348,1521,3368,1637,911,5042,2002,3325,4841,3567,4971,18,691,1345,1795,4384,4133,2607,4202,2638,4499,4194,2231,2896,3473,539,681,4226,969,943,2528,485,174,3264,3633,905,1261,4130,344,904,726,4725,4534,813,901,2953,2379,4582,2463,3335,2912,4872,4494,5074,902,2875,1410,3081,3797,4489,3909,3699,1787,2330,1993,1365,2435,1189,2008,155,3715,5027,4514,4299,2331,4145,3895,3140,83,4830,4020,14,3511,2788,738,4394,2294,1399,4124,4810,4120,744,84,553,4789,697,2316,1195,3195,3186,1472,249,4834,2816,1686,2782,5052,2473,5020,3793,3749,1397,4093,2990,1141,5038,4228,1030,4239,2180,599,4678,4465,4618,369,1234,2465,527,1549,4359,236,4961,4454,2298,4680,1449,2531,2300,4655,2965,3789,3356,3635,4170,541,479,2692,1865,4674,179,888,3947,2576,490,3629,231,4356,5010,1240,470,4642,4433,5058,916,1201,894,3375,3146,2653,2523,1853,1882,4913,2431,2860,3303,2880,228,686,3055,3881,2478,3586,514,642,1011,3627,713,3665,3556,3452,760,4180,1455,3811,364,2511,3362,5041,2497,1728,2084,2164,771,3415,4803,3137,3822,347,627,4664,1807,2364,3959,362,890,4484,164,3351,2041,4863,4009,2130,2792,456,3744,2471,3986,3057,378,4117,4979,4649,1377,4754,4624,917,1677,3321,791,1483,1494,2852,2273,1627,2047,613,1560,3377,122,1902,4794,73,2105,154,2594,882,576,2193,1719,3338,3302,2363,2960,2178,2984,3199,1277,2230,988,4077,2046,1759,4559,4748,2850,4614,3985,4382,3619,2817,4996,4054,1954,2005,3544,24,4741,4444,4965,2285,2131,245,365,2212,3143,2575,85,2380,2474,689,372,936,804,2760,2942,2735,1104,3942,4681,2503,1590,2566,1579,2313,4385,5032,3153,2206,2857,4294,3172,4558,4414,285,3205,1924,3772,224,5028,3287,4245,173,332,1821,4048,5089,1748,4459,163,3687,1501,1039,4768,2855,1354,1726,106,1454,1935,2778,5082,3641,3965,3331,803,3233,3741,4518,4774,2251,1173,4744,3443,1442,2026,1972,4347,1891,3861,450,1980,4064,2505,779,3872,3481,2011,2755,1296,798,4861,1015,2325,3828,1700,1971,1858,3577,787,705,3948,4707,4070,2690,1145,3659,818,4925,2049,3486,2174,4298,4750,4219,2826,2087,391,1540,2943,1532,4757,4051,4798,2339,4560,1438,3562,1080,819,4309,4975,3649,1712,4446,4517,3996,1941,45,4488,3730,1569,4804,4850,2318,4353,3429,3248,44,2510,1460,1408,3318,4751,201,2499,4305,4791,4213,2163,4712,1588,1177,5011,933,2881,3558,2909,4963,4344,2060,3980,3262,2427,350,300,1612,1753,1002,4667,2368,3190,3938,2123,2534,763,3784,3862,278,2904,2213,4941,3515,2922,1401,2533,12,3221,4389,5115,3315,1369,4936,1703,4552,4813,3868,3913,4735,2472,4161,4164,3845,1375,2226,4098,3984,2903,3114,395,971,525,577,1957,207,2578,3579,1688,5124,1573,2648,4123,2481,1987,3276,2268,4103,488,5035,2470,582,1743,4831,1888,2521,4550,2751,1358,3825,1166,2464,1857,457,1737,5069,1258,1815,2160,941,1150,3561,5067,4257,509,811,3118,4342,2349,5097,2514,611,1609,574,1537,198,1179,3799,870,2184,1922,3866,694,4106,3764,2155,3227,2140,1056,2143,4891,4490,3367,3952,724,1509,4563,2293,3777,2112,1065,2299,208,4282,3344,2711,4409,1025,3483,4561,1213,4269,1675,469,4980,2452,4241,4307,132,4854,2133,1874,2150,3988,1574,188,1376,171,4041,2064,1275,464,2200,4905,437,1720,1754,2634,4764,317,4085,838,3776,4102,5022,1827,36,2443,4056,4204,4287,1806,1985,3570,4572,990,2365,1504,4728,4611,4609,4222,5001,306,2121,550,4545,41,3009,2024,2980,3319,4500,4436,4006,5114,2672,4323,4814,3414,4113,49,2930,2015,1256,2090,1091,2307,477,740,4540,3785,2292,4393,530,1773,3164,2395,274,4052,3100,2962,2401,1038,4511,2181,4112,1767,4784,3005,211,3295,356,2191,3387,405,4300,2100,2544,3870,1388,995,4296,1939,1156,2439,2982,3480,597,4701,3383,2807,3592,3702,218,2333,3132,1340,3111,430,2665,1045,4290,366,4266,246,786,3979,2998,2158,2263,2753,2548,3361,4740,4940,3030,790,2573,454,409,4427,3685,2945,4183,1285,3826,398,3200,2410,959,2795,970,873,3424,2819,330,2390,2449,2761,3620,87,4765,2790,2661,2436,1017,2394,4284,796,4536,3963,1730,1599,4186,4404,2832,357,4815,2791,1481,4231,2029,3382,4756,629,1036,2066,4075,4819,3214,4727,1338,2628,823,5021,4901,1355,3684,1075,4817,1211,1479,3743,3044,4481,4441,3582,3889,42,543,4621,1181,1413,342,3090,3370,4066,4291,4745,4509,1174,2611,3363,3606,4176,2597,401,3492,4473,2342,3612,375,411,1322,2883,1022,3119,3691,26,1331,4379,2257,518,2192,1839,1835,3372,4220,4386,1622,2631,2352,3378,2524,1765,2106,2728,1000,2353,964,1825,1037,723,1647,1551,1067,2302,4843,1568,2424,4758,4661,3292,4267,4318,2031,1486,1255,2928,4013,5036,1228,2088,3539,307,1151,3930,2764,359,1816,4025,758,3401,1200,3716,609,3748,336,1169,107,3790,3831,1153,2420,4462,2600,4083,1916,863,2864,374,4693,875,2455,2219,3849,1276,587,5093,2117,1636,3664,4865,229,2132,2787,3898,4938,3174,2028,1239,2446,2606,311,3434,4653,4530,2694,1723,2946,1578,3298,1003,4989,3836,4110,3158,440,4845,3340,4196,2201,3498,1293,458,2073,1114,4840,1019,3904,3130,1506,1570,1383,1220,572,2626,2037,1370,2198,4417,4688,3935,2538,3261,1946,3853,966,2741,1580,3216,3392,4909,5112,4240,501,69,1309,3884,5008,1084,1831,1500,118,2104,4916,2407,3694,1297,885,1194,2794,4656,1994,3238,146,3669,4322,4011,3773,169,119,2022,4723,4697,4366,3531,706,3091,2929,441,351,867,1829,757,1230,78,2765,2314,1694,2416,780,1246,2072,3520,947,3187,2242,1886,3851,135,345,5086,4894,2224,1794,615,5091,3408,1249,560,2048,3435,1997,3346,1147,2992,1315,2141,2932,3255,2190,1132,1702,148,825,1905,2901,852,360,3560,989,4818,3101,2222,3529,447,1887,1304,373,1783,4771,199,4461,3733,635,3320,185,90,797,1528,3568,4883,3334,3449,3218,3442,3974,2910,607,3625,4778,3857,2532,3672,4960,1492,4162,4383,1676,2477,1661,1040,368,4062,1287,3277,4596,4237,2723,2949,2876,704,1975,4470,4402,1127,4354,415,3540,5046,3818,5080,2406,1411,2784,2391,3256,2671,1158,3524,2229,4442,1623,3787,4730,826,2456,2622,3019,2976,383,857,769,1820,3873,2642,2560,4570,1184,3991,31,3493,3494,2921,2081,2865,3819,2620,4370,3198,765,523,913,2589,326,650,2924,3622,2018,1478,1155,2289,4095,2824,3882,4043,585,4565,1929,927,2079,2684,2504,3053,2623,3499,4486,2095,3065,71,1735,2500,3201,4510,1259,72,159,3074,2413,1734,5048,1347,4225,1903,2822,1299,3923,1776,1253,2355,451,4848,46,4094,4457,109,1396,725,1669,817,4329,4995,2956,495,3270,4972,4724,3099,1944,1745,168,1328,1988,1871,2051,321,1161,4150,2232,4227,3914,4825,3834,79,1266,3753,2369,1357,2813,2972,3695,1031,1241,4780,3780,381,194,3222,4214,3350,5034,4024,3721,3209,4603,2667,4203,2863,665,4683,2718,3240,1904,3756,4601,1646,3763,1992,2462,3535,3056,987,982,728,302,1566,4195,1418,721,4526,3328,19,579,2498,2208,203,2793,1107,814,1069,3973,952,112,1043,241,2977,316,968,189,564,98,3566,1761,4851,720,3618,3128,535,3068,4942,1098,854,4293,939,944,390,4286,4247,3883,3543,468,2997,143,4640,3133,2319,1074,320,1543,2964,709,4136,4401,829,1125,1463,4721,3578,4452,3911,2399,3185,324,1502,1995,2893,4268,2870,1341,2572,1983,3259,1443,151,2017,4828,4959,2729,4381,3674,389,4047,4125,1288,2384,204,4512,4325,1417,3941,565,4438,4929,2033,3002,2969,2798,2545,1523,2044,4482,3170,4373,4532,4749,275,994,3839,1960,1559,2092,999,3623,3016,435,404,962,2262,2907,3604,240,3726,4493,4903,242,4853,161,3977,1456,1279,4119,2185,2405,1317,1680,3840,2783,4838,3197,2297,2239,2814,4477,4635,2750,1324,2809,4115,1077,4976,1870,4660,799,2138,487,181,1095,2327,259,346,1403,2507,3454,3950,2615,3648,617,3720,48,1488,1426,4882,2053,2621,3332,3616,1364,4236,4679,2134,3073,554,566,1485,4522,4302,2359,3686,4753,1058,841,3628,1214,1271,3712,1050,3711,1447,1672,1018,2820,4943,3583,4808,1451,4705,4953,3036,1938,1301,1959,1848,413,623,1774,1510,1146,1943,3858,956,4788,3906,2799,4487,82,505,1334,3407,499,1055,4235,3783,1021,4424,3192,1314,4806,1684,4690,767,2493,4888,630,1068,532,3110,4962,1457,139,3660,1250,4036,4189,4857,2800,57,752,1116,555,3054,1470,3869,3066,2927,4405,3833,1862,5084,840,4132,3848,1786,337,10,2366,1060,4906,3676,5043,3025,1715,889,492,3903,4644,3460,3514,4338,2655,3266,842,3821,449,4288,2108,2587,3080,3767,2669,233,1049,2177,2341,4422,3816,2151,1032,2310,834,4820,1435,1073,1645,1135,2662,3466,3791,2490,3624,3646,4206,1949,130,184,3006,1649,1936,2027,879,5051,1188,4931,3120,2762,4984,884,3970,1763,4722,511,5039,1699,1798,1313,3671,4809,3708,5079,880,4695,473,3864,2266,1059,849,2296,2851,4676,349,2491,1245,3409,5009,1619,2605,4458,1512,77,2194,1437,3269,2238,1958,4281,789,778,707,4628,2437,3357,114,4078,466,403,51,4720,2614,2400,4212,1149,1467,4053,1498,1691,2259,3404,1412,3510,2666,2197,2006,1667,1666,3229,3161,4126,1973,380,750,710,3241,2074,563,2489,5017,4392,253,824,1899,2940,4543,2271,2061,1337,3591,618,4918,4265,4652,1465,1062,2676,3150,2422,3263,3029,2311,2459,3696,4340,2660,3820,491,3805,3217,768,4733,4521,4633,416,4686,4610,4583,4829,2663,3148,3219,4947,4578,5060,4035,2209,3354,4280,4224,1416,1109,4184,4899,2936,4839,1654,739,3342,1911,3289,5025,984,4689,3760,4122,3228,3488,1110,5081,3800,4541,4055,180,2270,3802,696,2004,4230,1593,3801,363,2859,3796,3595,2237,3225,1243,2414,50,701,328,3138,2736,1594,4546,3803,4448,4475,534,1352,502,2175,3301,1319,1290,4566,4171,3910,4569,3953,1738,472,1262,2476,4292,926,4516,305,3121,474,2592,3885,190,4866,2908,4201,4010,3934,2096,5068,432,978,2651,688,3189,3747,3936,1836,5123,3296,3052,142,2652,4439,3689,3690,1931,5062,1918,186,3416,651,1668,4391,3722,2668,4179,2915,298,919,4215,3908,5066,2758,93,1281,4997,318,2253,1942,3750,4709,2780,2687,1948,3954,4871,531,730,4930,806,937,4574,56,3770,4432,127,4636,835,2931,2654,1679,3112,4483,3215,3304,864,37,1771,2923,1461,1757,4675,3252,3875,2995,1227,2525,1231,1390,2267,3841,4638,3542,3366,593,3108,493,513,977,2107,1359,1034,272,3045,1199,1784,1384,1736,2867,3688,258,4665,2970,3180,2571,3850,1813,3179,1659,243,3731,4398,4160,812,4607,4406,1444,2114,3634,4479,2806,1598,3545,2039,2550,2913,3554,1799,3286,4612,1212,261,3275,4097,1081,5118,2488,4917,679,177,2868,4736,2563,4944,2244,4362,2461,1692,1952,2254,400,4775,2916,3900,2320,903,4983,4278,899,312,297,2539,3552,4021,2009,2866,2432,1587,734,4620,924,1883,2810,2248,4400,1989,5030,4210,1395,3778,322,3062,2205,2305,3581,1731,4089,4157,5007,2574,2608,1685,227,3358,2337,273,2419,1819,276,731,921,4716,3400,3031,3757,891,1842,3231,836,1854,43,1257,4167,1951,4615,4116,1076,4567,2558,1914,925,4637,4474,3171,4333,2700,6,4081,2727,3403,604,3094,1837,335,3018,979,27,538,1289,5077,167,2203,197,3683,1577,3061,3482,2013,255,4411,3968,4869,3316,2968,4646,3035,4579,5059,1078,439,3223,3444,4531,128,915,2555,4860,2460,3637,1660,794,3017,1998,2260,4149,478,4128,802,60,436,2677,3553,2272,1294,3336,280,592,1955,660,4343,715,3528,1329,2196,4856,4434,3992,4968,22,5047,3288,111,1310,3232,3267,2635,1673,3751,3126,3768,4152,1780,3309,3916,455,4348,2445,1633,2283,544,3470,3239,4588,2434,656,877,4285,4520,1607,860,2714,4279,556,1012,4769,2466,1105,1563,4508,1898,2613,160,1046,2961,3879,3838,3291,3673,4455,2797,512,3905,4315,3230,5023,1033,4776,4539,1071,4445,4000,4478,4199,141,1586,3469,1360,639,2882,4250,3253,795,4591,2535,2418,257,2685,1121,105,3611,1790,388,951,2080,1251,1508,460,1698,878,1950,4049,3786,348,4622,1349,1387,2480,2409,865,1877,845,4668,4904,699,636,2688,4956,638,156,4360,4159,5014,3738,598,2989,3887,1378,4437,2372,1323,3406,3254,288,922,3771,1441,3614,1772,3788,1226,3163,3573,3279,856,3958,2506,4369,3814,2335,561,4525,2837,3564,2673,2704,1785,1524,92,832,893,2256,869,2683,4898,3007,4211,4190,4032,843,3393,1178,424,1424,3662,5119,3504,2853,874,690,3023,4429,1010,1450,3945,4042,3981,2756,1945,2733,2979,1507,1089,1713,2169,2040,981,4852,3644,1368,1252,1539,4672,3360,1739,2354,434,1890,2869,2116,3943,3078,1674,3518,4015,783,678,3176,3804,1732,1480,4061,2207,3051,2385,1529,4990,1144,1206,2557,1458,2546,497,4528,3243,1611,4378,4985,2644,1718,809,1791,519,2831,1977,1326,1518,1484,2703,792,2317,1096});
}